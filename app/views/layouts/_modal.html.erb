


 <!-- Button trigger modal -->
  
     
      <a class="popup-modal call-to-action" href="#test-modal">
      <i class="icon-pencil"></i>
      <p> Sign up</p>
      </a>

      
                  

<!-- Modal -->
    <div id="test-modal" class="white-popup-block mfp-hide">
    
      <div class="modal-dialog modal-small container row">
    
        <div class="modal-content">
    
          <div class="modal-header">
    
            <p><a class="popup-modal-dismiss pull-right" href="#">&times;</a></p>
                  
                  <%= image_tag "logo.png", class: "plain-logo center-block"   %> 
      
            <h4 class="modal-title text-center">Sign up now!</h4>
            <p class="text-center "> This is the first step to new you. Best part, it's free for 14 days! </br> if you cancel before your trial period is over you wont be charged  </p>

           
           
          </div>
    
          <div class="modal-body sign_up">
    
           <%= form_for(resource, as: resource_name, url: registration_path(resource_name), remote: true) do |f| %>
          <%= devise_error_messages! %>


          <div class="form-group">
                    <%= f.text_field :name, class: 'form-control', placeholder: "Your Name" %>
          </div>

          <div class="form-group">
            <%= f.email_field :email,class: 'form-control', placeholder: "Your Email", autofocus: true %>
          </div>

          <div class="form-group">
            <%= f.password_field :password, class: 'form-control', placeholder: "Your Password (8 characters minimum)", autocomplete: "off" %>
          </div>

          <div class="form-group">
            <%= f.password_field :password_confirmation,class: 'form-control', placeholder: "Password Confirmation", autocomplete: "off" %>
          </div>

  
            <%= f.submit "Sign up", class: 'btn btn-info btn-fill btn-block'  %>

            <% end %>

          

<div class="card card-price stripe-form">
                            <div class="content">
                                <h6 class="category">Your Plan</h6>
                                <h1 class="price">
                                    <small>$</small>14<small> /mo</small>
                                </h1>                        
                                
                                <ul class="list-unstyled list-lines">
                                    <li>
                                      <i class="fa fa-check"></i> <b>Unlimited</b> access to all programs, recipes, and corrective exercise
                                    </li>
                                    <li>
                                      <i class="fa fa-check"></i>  <b>Constant</b> updates and new programs
                                    </li>
                                    <li>
                                        <i class="fa fa-check"></i>  <b>Learn</b> to cook healthy meals
                                    </li>
                                    <li>
                                        <i class="fa fa-check"></i> </i> <b>Cancel</b> anytime
                                    </li>
                                </ul>
                            </div>
                            <div class="footer">
                              <%= render 'layouts/stripeform' %>
                            </div>
                        </div>

                       
       </div>


       
       <%= render 'layouts/policies' %>
       


<div class="subscription">
 <%= form_for(:subscription, remote: true, :url => {:action => 'create'}) do |f| %>

                            <div> 
                               
                              <%= f.check_box :subscribed, {}, "true", "false"%>
                              <%= label_tag(:subscribed, "Accept our terms and policies") %> 
                            </div>

                            
                            <div class="actions">
                            <%= f.submit "Accept our Terms and Privaciy Policy", class: 'btn btn-success btn-fill btn-block' %>
                            </div>

                       
                          <% end %>

       
</div>
</div>
      
<div class="modal-footer">
       <span class="text-muted">Looking to <%= link_to "Log in", new_session_path(resource_name) %>?</span>
      </div>

      
        </div>
    
      </div>
    


    </div>

    <script type="text/javascript">
   
    $(document).on("ready page:load", function() {

        $(function () {
  $('.popup-modal').magnificPopup({
    
    type: 'inline',
    preloader: false,
    focus: '#user_name',
    modal: true
  });
  $(document).on('click', '.popup-modal-dismiss', function (e) {
    e.preventDefault();
    $.magnificPopup.close();
  });
});  



        $('.stripe-form').hide();// hide stripe form
        $('#subscribe_user').hide();
         jQuery.validator.setDefaults({
    debug: false,
    success: "valid"
});;
        $('#new_user').validate({
          rules : {
             'user[name]' : { required : true,
                           minlength : 2 
                         }, //END OF USERNAME
              'user[email]' : { required : true,
                           email : true,
                           remote:"/users/check_email"
                         },  // end of email
              'user[password]' : { required : true,
                           minlength : 8
                         },  // end of password 
               'user[password_confirmation]' : { required : true,
                           equalTo : "#user_password"
                         },  // end of password 
          },//end of rules
          messages: {
    'user[name]': "Please specify your name",
    'user[email]': {
      required: "We need your email address to contact you",
      email: "Your email address must be in the format of name@domain.com",
      remote: "This email is already taken"
    },// end of email
     'user[password]': {
      required: "Please enter a password",  
    },
    'user[password_confirmation]': {
      required: "Please Re-enter your password ",
      equalTo: "Please make sure the passwords are equal"
    }
  }
        }); // end validation
$('#new_user').on('submit', function(event) {
  event.preventDefault();
   $.ajax('/users', {
    type: 'POST',
    });   
    if($(this).valid()) {
            alert('the form is valid');
            $('#new_user').remove();
            $('#subscribe_user').fadeIn(400);
        }
       }); 
  
$('.subscription form').validate({
  rules : {
             'subscription[subscribed]' : 'required'
                         
          }, //end of rules
    messages : {  
      'subscription[subscribed]'  : ' please click here to '
      }  
});


$('#subscribe_user').on('submit', function(event) {
  event.preventDefault();
   $.ajax('/static_pages', {
    type: 'POST',
    });   
    
            $('.stripe-form').fadeIn(400);
            $('#subscribe_user').fadeOut(400);
       }); 
             
var $success = $('#f37e68'); 
$success.waypoint(function () { 
  console.log('Waypoint!');
  });
}); // end ready
      </script>
